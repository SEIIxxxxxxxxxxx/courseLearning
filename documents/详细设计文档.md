# 课程学习网站 courselearning 软件详细设计描述文档

## 文档作者

主要编写者：钟山

其他编写者：石善羽、余欣然、黄昱霖

## 文档修改历史

| 修改人员                     | 日期      | 修改原因                 | 版本号 |
| ---------------------------- | --------- | ------------------------ | ------ |
| 钟山                         | 2021.6.13 | 创建文档，完成引言部分   | v0.1   |
| 钟山、石善羽                 | 2021.6.18 | 完成包图绘制             | v0.2   |
| 钟山                         | 2021.6.26 | 添加展示层部分           | v0.3   |
| 钟山                         | 2021.7.6  | 添加业务逻辑层部分       | v0.4   |
| 钟山                         | 2021.7.7  | 添加数据层部分，完成编写 | v0.5   |
| 黄昱霖、石善羽、余欣然、钟山 | 2021.7.10 | 文档评审和完善           | v0.6   |



## 目录

[TOC]

## 1. 引言

### 1.1 编制目的

本报告详细完成对课程学习网站courselearning系统的详细设计，达到指导后续软件构造的目的，同时实现和测试人员及用户的沟通。

本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。

### 1.2 词汇表

详细设计描述的约定详见下表所示：

| 下文出现名词 |        对应全称或具体含义        |
| :----------: | :------------------------------: |
|     系统     |    courselearning课程学习系统    |
|     用户     | 在不区分老师和学生下对两者的统称 |

### 1.3 参考资料

1）  IEEE用例文档标准。

2）《软件工程与计算（卷二）—— 软件开发的技术基础》

3） 课程学习网站（courselearning）用例文档、软件需求规格说明文档、体系结构描述文档

## 2. 产品概述

参考课程学习网站courselearning系统用例文档和软件需求规格说明文档中对产品的概括描述。



## 3. 体系结构设计概述

参考课程学习网站courselearning系统体系结构设计文档。



## 4. 结构视角

### 4.1 展示层的分解

展示层的开发包图参见软件体系结构文档。

#### 4.1.1 courseorderui

##### 4.1.1.1 模块概述

courseorderui模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.1.1.2 整体结构

courseorderui包位于展示层，定义了学生租用课程的界面。内部包含CourseList、HistoryOrder模块，提供租用课程的功能，实现了职责的划分和封装。

courseorderui模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-d0cf4b3489496927.JPG?imageMogr2/auto-orient/strip|imageView2/2/w/468/format/webp)

courseorderui模块各个类的职责如下表所示。

| 模块         | 职责                                       |
| ------------ | ------------------------------------------ |
| CourseList   | 负责提供给学生支付租用课程费用功能         |
| HistoryOrder | 负责展示订单信息（包括购买订单和租用订单） |

##### 4.1.1.3 模块内部类的接口规范

###### 4.1.1.3.1 CourseList模块的接口规范

提供的服务（供接口）

* `CourseList.showDialog`
  * 语法：`showDialog (courseId, courseName, coursePrice,orderType)`
  * 前置条件：学生已登录
  * 后置条件：系统返回租用课程的界面（弹窗）
* `CourseList.confirmPayment`
  * 语法：`confirmPayment()`
  * 前置条件：学生已确定支付订单
  * 后置条件：系统调用`CourseOrderController`的`payOrder`方法和`createCourseOrder`方法

需要的服务（需接口）

| 服务名                                                       | 服务             |
| ------------------------------------------------------------ | ---------------- |
| `CourseOrderContoller.payOrder(Integer orderId, Integer duration, Integer rentCost)` | 学生支付租用订单 |
| `CourseOrderController.createCourseOrder(Integer courseId, Integer userId, Integer type)` | 创建租用订单     |

###### 4.1.1.3.2 HistoryOrder模块的接口规范

提供的服务（供接口）

* `History.getOrder`
  * 语法：`getOrder()`
  * 前置条件：学生进入查看订单界面
  * 后置条件：系统调用`CourseOrderController`的`getCourseOrders`方法

需要的服务（需接口）

| 服务名                                               | 服务             |
| ---------------------------------------------------- | ---------------- |
| `CourseOrderContoller.getCourseOrders (Integer uid)` | 学生查看租用订单 |



#### 4.1.2 viporderui

##### 4.1.2.1 模块概述

viporderui模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.1.2.2 整体结构

viporderui包位于展示层，定义了学生购买会员的界面。内部包含UserCenter模块，提供购买会员的功能，实现了职责的划分和封装。

viporderui模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-1d70dc366084bd4b.png?imageMogr2/auto-orient/strip|imageView2/2/w/306/format/webp)

viporderui模块各个类的职责如下表所示。

| 模块       | 职责                       |
| ---------- | -------------------------- |
| UserCenter | 负责提供给学生购买会员功能 |

##### 4.1.2.3 模块内部类的接口规范

###### 4.1.2.3.1 UserCenter模块的接口规范

提供的服务（供接口）

* `UserCenter.handleVip`
  * 语法：`handleVip()`
  * 前置条件：无
  * 后置条件：调用`CourseOrderController`的`payOrder`方法

需要的服务（需接口）

| 服务名                                                       | 服务             |
| ------------------------------------------------------------ | ---------------- |
| `VIPOrderContoller.createVIPOrder (Integer uid, Integer type)` | 学生支付租用订单 |
| `VIPOrderContoller.getVipEndTime (Integer userId)`           | 获取会员到期时间 |
| `VIPOrderContoller.checkVIP (Integer userId)`                | 判断会员身份     |



#### 4.1.3 questionui

##### 4.1.3.1 模块概述

questionui模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.1.3.2 整体结构

questionui包位于展示层，定义了教师创建题目的界面。内部包含QuestionCreate模块，提供创建题目的功能，实现了职责的划分和封装。

questionui模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-1cfd7cc2811f9131.png?imageMogr2/auto-orient/strip|imageView2/2/w/288/format/webp)

questionui模块各个类的职责如下表所示。

| 模块           | 职责                       |
| -------------- | -------------------------- |
| QuestionCreate | 负责提供给教师创建题目功能 |

##### 4.1.3.3 模块内部类的接口规范

###### 4.1.3.3.1 QuestionCreate模块的接口规范

提供的服务（供接口）

* `QuestionCreate.createOptions`
  * 语法：`createOptions()`
  * 前置条件：教师进入创建题目界面（弹窗）
  * 后置条件：系统返回创建的选项，展示在创建题目界面上
* `QuestionCreate.submit`
  * 语法：`submit()`
  * 前置条件：教师完成创建题目并确认
  * 后置条件：调用`CourseOrderController`的`payOrder`方法

需要的服务（需接口）

| 服务名                                                   | 服务                   |
| -------------------------------------------------------- | ---------------------- |
| `QuestionContoller.createQuestion (QuestionVO question)` | 创建题目               |
| `QuestionContoller.getQuestionById (String id)`          | 根据题目id查找对应题目 |
| `QuestionConroller.getQuestion ()`                       | 返回题库中全部题目     |



#### 4.1.4 examui

##### 4.1.4.1 模块概述

examui模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.1.4.2 整体结构

examui包位于展示层，定义了教师创建测试和学生查看测试的界面。内部包含ExamCreate和ExamPeek模块，提供创建测试和查看测试的功能，实现了职责的划分和封装。

examui模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-2c0a0d87223a8f99.png?imageMogr2/auto-orient/strip|imageView2/2/w/601/format/webp)



examui模块各个类的职责如下表所示。

| 模块       | 职责                       |
| ---------- | -------------------------- |
| ExamCreate | 负责提供给教师创建测试功能 |
| ExamPeek   | 负责提供给学生查看测试功能 |

##### 4.1.4.3 模块内部类的接口规范

###### 4.1.4.3.1 ExamCreate模块的接口规范

提供的服务（供接口）

* `ExamCreate.searchQuestions`
  * 语法：`searchQuestions()`
  * 前置条件：教师输入课程号
  * 后置条件：系统返回课程号对应的题目，展示在创建测试界面上
* `ExamCreate.submit`
  * 语法：`submit()`
  * 前置条件：教师完成创建测试并确认
  * 后置条件：调用`ExamController`的`createExam`方法

需要的服务（需接口）

| 服务名                                                  | 服务                   |
| ------------------------------------------------------- | ---------------------- |
| `ExamContoller.createExam (ExamVO exam)`                | 创建测试               |
| `QuestionContoller.getCourseQuestion (String courseId)` | 根据课程id查找对应题目 |

###### 4.1.4.3.2  ExamPeek模块的接口规范

提供的服务（供接口）

* `ExamPeek.handleContinueExams`
  * 语法：`handleContinueExams()`
  * 前置条件：学生已购买或租用该门课程
  * 后置条件：系统返回进行中测试，展示在查看测试界面上
* `ExamPeek.handleOverExams`
  * 语法：`handleOverExams()`
  * 前置条件：学生已购买或租用该门课程
  * 后置条件：系统返回已结束测试，展示在查看测试界面上
* `ExamPeek.takeExam`
  * 语法：`takeExam(examId)`
  * 前置条件：学生购买或租用的课程中包含进行中测试
  * 后置条件：系统跳转至该测试答题界面
* `ExamPeek.peekResult`
  * 语法：`peekResult(examId)`
  * 前置条件：学生购买或租用的课程中包含已结束测试
  * 后置条件：系统跳转至该测试结果查看界面

需要的服务（需接口）

| 服务名                                             | 服务                   |
| -------------------------------------------------- | ---------------------- |
| `ExamContoller.getContinueExam (Integer courseId)` | 得到进行中测试         |
| `ExamContoller.getOverExam (Integer courseId)`     | 根据课程id查找对应题目 |



#### 4.1.5 userexamui

##### 4.1.5.1 模块概述

userexamui模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.1.5.2 整体结构

userexamui包位于展示层，定义了学生购买会员的界面。内部包含TakeExam和PeekResult模块，提供创建测试和查看测试的功能，实现了职责的划分和封装。

userexamui模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-dde912a23178835e.png?imageMogr2/auto-orient/strip|imageView2/2/w/787/format/webp)

userexamui模块各个类的职责如下表所示。

| 模块       | 职责                                 |
| ---------- | ------------------------------------ |
| TakeExam   | 负责提供给学生作答进行中测试功能     |
| PeekResult | 负责提供给学生查看已结束测试结果功能 |

##### 4.1.5.3 模块内部类的接口规范

###### 4.1.5.3.1 TakeExam模块的接口规范

提供的服务（供接口）

* `TakeExam.refresh`
  * 语法：`refresh()`
  * 前置条件：无
  * 后置条件：系统返回该测试所有题目，展示在测试作答界面上
* `TakeExam.submit`
  * 语法：`submit()`
  * 前置条件：学生完成该测试所有题目的作答
  * 后置条件：调用`UserExamController`的`setUpExam`方法

需要的服务（需接口）

| 服务名                                              | 服务                   |
| --------------------------------------------------- | ---------------------- |
| `UserExamContoller.setUpExam (UserExamVO userExam)` | 提交测试               |
| `QuestionContoller.getQuestionById (String id)`     | 根据题目id查找对应题目 |

###### 4.1.5.3.2  ExamPeek模块的接口规范

提供的服务（供接口）

* `PeekResult.refresh`
  * 语法：`refresh()`
  * 前置条件：学生已购买或租用该门课程
  * 后置条件：系统返回该测试得分、所有题目信息及学生答案，展示在查看测试结果界面上

需要的服务（需接口）

| 服务名                                                       | 服务                   |
| ------------------------------------------------------------ | ---------------------- |
| `UserExamContoller.getUserExam (Integer userId,Integer examId)` | 得到用户测试           |
| `ExamContoller.getExamById (Integer eid)`                    | 返回对应测试号的测试   |
| `QuestionController.getQuestionById (String id)`             | 根据题目id查找对应题目 |



#### 4.1.6 展示层的动态模型

下图表明了上述展示层界面（模块）的跳转关系。

![img](https://upload-images.jianshu.io/upload_images/17506620-96e5aee2ed306011.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)



### 4.2 业务逻辑层的分解

业务逻辑层的开发包图参见软件体系结构文档。

#### 4.2.1 courseorderbl

##### 4.2.1.1 模块概述

courseorderbl模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.2.1.2 整体结构

courseorderbl包位于业务逻辑层。根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。在展示层和业务逻辑层之间，我们添加courseorderservice接口；在业务逻辑层和数据层之间，我们添加courseordermapper接口。

为了隔离业务逻辑职责和逻辑控制职责，我们增加了courseordercontroller，这样courseordercontroller会将对租用课程的业务逻辑的实现委托给courseorderservice接口，并由courseorderserviceImpl类进行实现。CourseOrderPO是作为租用记录的持久化对象被添加到设计模型中去的。运用了面向接口编程原则、依赖倒置原则。

courseorderbl模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-a6f861606747f264.png?imageMogr2/auto-orient/strip|imageView2/2/w/1030/format/webp)

courseorderbl模块各个类的职责如下表所示。

| 模块                   | 职责                             |
| ---------------------- | -------------------------------- |
| courseordercontroller  | 负责对接前端的接口               |
| courseorderservice     | 负责抽象出租用课程相关方法的接口 |
| courseorderserviceImpl | 负责实现租用课程相关方法         |

##### 4.2.1.3 模块内部类的接口规范

###### 4.2.1.3.1 courseordercontroller模块的接口规范

提供的服务（供接口）

* `CourseOrderController.payOrder`
  * 语法：`public ResultVO<Boolean> payOrder(@RequestParam Integer orderId, @RequestParam Integer duration, @RequestParam Integer rentCost)`
  * 前置条件：无
  * 后置条件：系统调用`CourseOrderservice `的`payOrder`方法
* `CourseOrderController.getCourseOrders`
  * 语法：`public List<CourseOrderVO> getCourseOrders(@PathVariable Integer uid)`
  * 前置条件：无
  * 后置条件：系统调用`CourseOrderservice `的`getCourseOrders`方法
* `CourseOrderController.createCourseOrder`
  * 语法：`public ResultVO<CourseOrderVO> createCourseOrder(@RequestParam Integer uid, @RequestParam Integer courseId, @RequestParam Integer type)`
  * 前置条件：无
  * 后置条件：系统调用`CourseOrderService`的`createCourseOrder`方法

需要的服务（需接口）

| 服务名                                                       | 服务             |
| ------------------------------------------------------------ | ---------------- |
| `CourseOrderService.payOrder(Integer orderId, Integer duration, Integer rentCost)` | 完成付款         |
| `CourseOrderService.getCourseOrders(Integer uid)`            | 获取指定学生订单 |
| `CourseOrderService.createCourseOrder(Integer courseId, Integer userId, Integer type)` | 创建租用订单     |

###### 4.2.1.3.2 courseorderservice模块的接口规范

提供的服务（供接口）

* `CourseOrderService.payOrder`
  * 语法：`ResultVO<Boolean> payOrder(Integer orderId, Integer duration, Integer rentCost)`
  * 前置条件：无
  * 后置条件：系统调用`CourseOrderServiceImpl `的`payOrder`方法
* `CourseOrderService.getCourseOrders`
  * 语法：`List<CourseOrderVO> getCourseOrders(Integer uid)`
  * 前置条件：无
  * 后置条件：系统调用`CourseOrderServiceImpl `的`getCourseOrders`方法
* `CourseOrderService.createCourseOrder`
  * 语法：`ResultVO<CourseOrderVO> createCourseOrder(Integer uid, Integer courseId, Integer type)`
  * 前置条件：无
  * 后置条件：系统调用`CourseOrderServiceImpl`的`createCourseOrder`方法

需要的服务（需接口）

| 服务名                                                       | 服务             |
| ------------------------------------------------------------ | ---------------- |
| `CourseOrderServiceImpl.payOrder(Integer orderId, Integer duration, Integer rentCost) ` | 完成付款         |
| `CourseOrderServiceImpl.getCourseOrders(Integer uid)`        | 获取指定用户订单 |
| `CourseOrderServiceImpl.createCourseOrder(Integer uid, Integer courseId, Integer type)` | 创建订单         |

###### 4.2.1.3.3 courseorderserviceImpl模块的接口规范

提供的服务（供接口）

* `CourseOrderServiceImpl.payOrder`
  * 语法：`public ResultVO<Boolean> payOrder(Integer orderId, Integer duration, Integer rentCost) `
  * 前置条件：无
  * 后置条件：系统修改用户余额
* `CourseOrderServiceImpl.getCourseOrders`
  * 语法：`List<CourseOrderVO> getCourseOrders(Integer uid)`
  * 前置条件：无
  * 后置条件：系统查询指定用户所有订单信息CourseOrderVO并以列表形式返回
* `CourseOrderServiceImpl.createCourseOrder`
  * 语法：`public ResultVO<CourseOrderVO> createCourseOrder(Integer uid, Integer courseId, Integer type)`
  * 前置条件：无
  * 后置条件：系统创建CourseOrderVO并返回

需要的服务（需接口）

| 服务名                                              | 服务                       |
| --------------------------------------------------- | -------------------------- |
| `CourseOrderMapper.selectByPrimaryKey(Integer id) ` | 查询租用订单供支付         |
| `CourseOrderMapper.selectByUserId(Integer userId)`  | 获取指定用户订单           |
| `CourseOrderMapper.insert(CourseOrder record)`      | 在数据库中插入租用订单记录 |

##### 4.2.1.4 业务逻辑层的动态模型

下图表明了课程学习系统中，当用户发起租用课程请求后，租用课程业务逻辑处理的相关对象之间的协作。

![img](https://upload-images.jianshu.io/upload_images/17506620-f0b127709fc8a142.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)

![img](https://upload-images.jianshu.io/upload_images/17506620-e327b2925ff1d43f.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)

其中，在CourseOrderServiceImpl类中，CourseOrder的变化状态图如下

![img](https://upload-images.jianshu.io/upload_images/17506620-c6d322f1cce62f30.JPG?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)



##### 4.2.1.5 业务逻辑层的设计原理

利用委托式控制风格，租用课程界面需要访问的业务逻辑由课程订单控制器委托给服务接口，再由课程订单具体类进行实现，运用了依赖倒置和面向接口编程的原则。 



#### 4.2.2 viporderbl

##### 4.2.2.1 模块概述

viporderbl模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.2.2.2 整体结构

viporderbl包位于业务逻辑层。根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。在展示层和业务逻辑层之间，我们添加viporderservice接口；在业务逻辑层和数据层之间，我们添加vipordermapper接口。

为了隔离业务逻辑职责和逻辑控制职责，我们增加了vipordercontroller，这样vipordercontroller会将对租用课程的业务逻辑的实现委托给viporderservice接口，并由viporderserviceImpl类进行实现。VIPOrderPO是作为租用记录的持久化对象被添加到设计模型中去的。运用了面向接口编程原则、依赖倒置原则。

viporderbl模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-3a45f8c24b3e7319.png?imageMogr2/auto-orient/strip|imageView2/2/w/1012/format/webp)

viporderbl模块各个类的职责如下表所示。

| 模块                | 职责                             |
| ------------------- | -------------------------------- |
| vipordercontroller  | 负责对接前端的接口               |
| viporderservice     | 负责抽象出购买会员相关方法的接口 |
| viporderserviceImpl | 负责实现购买会员相关方法         |

##### 4.2.2.3 模块内部类的接口规范

###### 4.2.2.3.1 vipordercontroller模块的接口规范

提供的服务（供接口）

* `VIPOrderController.createVIPOrder`
  * 语法：`public ResultVO<VIPOrderVO> createVIPOrder(@RequestParam Integer uid, @RequestParam Integer type)`
  * 前置条件：无
  * 后置条件：系统调用`vipservice `的`createVIPOrder`方法
* `VIPOrderController.getVipEndTime`
  * 语法：`public ResultVO<VIPOrderVO> createVIPOrder(@RequestParam Integer uid, @RequestParam Integer type)`
  * 前置条件：无
  * 后置条件：系统调用`vipservice `的`createVIPOrder`方法
* `VIPOrderController.checkVIP`
  * 语法：`public ResultVO<VIPOrderVO> createVIPOrder(@RequestParam Integer uid, @RequestParam Integer type)`
  * 前置条件：无
  * 后置条件：系统调用`vipservice `的`createVIPOrder`方法
* `VIPOrderController.createVIPOrder`
  * 语法：`public List<VIPOrderVO> createVIPOrder(@PathVariable Integer userId)`
  * 前置条件：无
  * 后置条件：系统调用`vipservice `的`createVIPOrder`方法

需要的服务（需接口）

| 服务名                                                      | 服务                           |
| ----------------------------------------------------------- | ------------------------------ |
| `VIPOrderService.getVipOrder(Integer userId, Integer type)` | 创建会员订单                   |
| `VIPOrderService.getVipEndTime(Integer userId)`             | 根据用户id获取该用户的会员信息 |
| `VIPOrderService.isVip(Integer uid)`                        | 判断会员身份                   |
| `VIPOrderService.getVipOrder(Integer userId)`               | 得到会员订单                   |

###### 4.2.1.3.2 viporderservice模块的接口规范

提供的服务（供接口）

* `VIPOrderService.getVipEndTime`
  * 语法：`ResultVO<String> getVipEndTime(Integer uid)`
  * 前置条件：无
  * 后置条件：系统调用`VIPOrderServiceImpl `的`getVipEndTime`方法
* `VIPOrderService.createVipOrder`
  * 语法：`ResultVO<VIPOrderVO> createVipOrder(Integer userId, Integer type)`
  * 前置条件：无
  * 后置条件：系统调用`VIPOrderServiceImpl `的`createVipOrder`方法
* `VIPOrderService.isVip`
  * 语法：`ResultVO<Boolean> isVip(Integer uid)`
  * 前置条件：无
  * 后置条件：系统调用`VIPOrderServiceImpl `的`isVip`方法
* `VIPOrderService.getVipOrder`
  * 语法：`List<VIPOrderVO> getVipOrder(Integer userId)`
  * 前置条件：无
  * 后置条件：系统调用`VIPOrderServiceImpl `的`getVipOrder`方法

需要的服务（需接口）

| 服务名                                                       | 服务                           |
| ------------------------------------------------------------ | ------------------------------ |
| `VIPOrderServiceImpl.getVipEndTime(Integer uid) `            | 根据用户id获取该用户的会员信息 |
| `VIPOrderServiceImpl.createVipOrder(Integer userId, Integer type) ` | 创建会员订单                   |
| `VIPOrderServiceImpl.isVip(Integer uid)`                     | 判断会员身份                   |
| `VIPOrderServiceImpl.getVipOrder(Integer userId)`            | 得到会员订单                   |

###### 4.2.1.3.3 viporderserviceImpl模块的接口规范

提供的服务（供接口）

* `VIPOrderServiceImpl.getVipEndTime`
  * 语法：`public ResultVO<String> getVipEndTime(Integer uid) `
  * 前置条件：无
  * 后置条件：系统创建包含会员到期日的ResultVO并返回
* `VIPOrderServiceImpl.createVipOrder`
  * 语法：`public ResultVO<VIPOrderVO> createVipOrder(Integer userId, Integer type) `
  * 前置条件：无
  * 后置条件：系统创建包含会员订单信息VIPOrderVO的ResultVO并返回
* `VIPOrderServiceImpl.isVip`
  * 语法：`public ResultVO<Boolean> isVip(Integer uid) `
  * 前置条件：无
  * 后置条件：系统创建包含是否为会员信息VIPOrderVO的ResultVO并返回
* `VIPOrderServiceImpl.getVipOrder`
  * 语法：`public List<VIPOrderVO> getVipOrder(Integer userId) `
  * 前置条件：无
  * 后置条件：系统查询包含会员订单信息VIPOrderVO的ResultVO并返回

需要的服务（需接口）

| 服务名                                           | 服务                     |
| ------------------------------------------------ | ------------------------ |
| `VIPOrderMapper.selectByUserId(Integer userId) ` | 查询指定用户全部会员订单 |
| `VIPOrderMapper.insert(VIPOrder record)`         | 在数据库中添加会员订单   |

##### 4.2.2.4 业务逻辑层的动态模型

下图表明了课程学习系统中，当用户发起购买会员请求后，购买会员业务逻辑处理的相关对象之间的协作。

![img](https://upload-images.jianshu.io/upload_images/17506620-1e4e57b7c4be7ceb.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)

其中，在VIPOrderServiceImpl类中，VIPOrder的变化状态图如下：

![img](https://upload-images.jianshu.io/upload_images/17506620-78a027ad8c64f095.JPG?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)



##### 4.2.2.5 业务逻辑层的设计原理

利用委托式控制风格，购买会员界面需要访问的业务逻辑由会员订单控制器委托给服务接口，再由会员订单具体类进行实现，运用了依赖倒置和面向接口编程的原则。 



#### 4.2.3 questionbl

##### 4.2.3.1 模块概述

questionbl模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.2.3.2 整体结构

questionbl包位于业务逻辑层。根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。在展示层和业务逻辑层之间，我们添加questionservice接口；在业务逻辑层和数据层之间，我们添加questionmapper接口。

为了隔离业务逻辑职责和逻辑控制职责，我们增加了questioncontroller，这样questioncontroller会将对创建题目、查询题目的业务逻辑的实现委托给questionservice接口，并由questionserviceImpl类进行实现。QuestionPO是作为题目的持久化对象被添加到设计模型中去的。运用了面向接口编程原则、依赖倒置原则。

questionbl模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-64502944fb528c8d.png?imageMogr2/auto-orient/strip|imageView2/2/w/1062/format/webp)

questionbl模块各个类的职责如下表所示。

| 模块                | 职责                                   |
| ------------------- | -------------------------------------- |
| questioncontroller  | 负责对接前端的接口                     |
| questionservice     | 负责抽象出创建、查找题目相关方法的接口 |
| questionserviceImpl | 负责实现创建、查找题目相关方法         |

##### 4.2.3.3 模块内部类的接口规范

###### 4.2.3.3.1 questioncontroller模块的接口规范

提供的服务（供接口）

* `QuestionController.createQuestion`
  * 语法：`public ResultVO<QuestionVO> createQuestion(@RequestBody QuestionVO question)`
  * 前置条件：无
  * 后置条件：系统调用`questionservice `的`createQuestion`方法
* `QuestionController.getCourseQuestion`
  * 语法：`public List<QuestionVO> getCourseQuestion(@PathVariable String courseId)`
  * 前置条件：无
  * 后置条件：系统调用`questionservice `的`getCourseQuestion`方法
* `QuestionController.getQuestionById`
  * 语法：`public ResultVO<QuestionVO> getQuestionById(@PathVariable String id)`
  * 前置条件：无
  * 后置条件：系统调用`questionservice `的`getQuestionById`方法
* `QuestionController.getQuestion`
  * 语法：`public List<QuestionVO> getQuestion()`
  * 前置条件：无
  * 后置条件：系统调用`questionservice `的`getAllQuestion`方法

需要的服务（需接口）

| 服务名                                                  | 服务                     |
| ------------------------------------------------------- | ------------------------ |
| `QuestionService.getAllQuestion()`                      | 获取所有题目信息         |
| `QuestionService.getQuestion(Integer courseID)`         | 获取指定课程号的题目信息 |
| `QuestionService.createQuestion(QuestionVO questionVO)` | 创建题目并返回题目信息   |
| `QuestionService.getQuestionById(Integer id)`           | 根据题目id号获取指定题目 |

###### 4.2.3.3.2 questionservice模块的接口规范

提供的服务（供接口）

* `QuestionService.getAllQuestion`
  * 语法：`List<QuestionVO> getAllQuestion()`
  * 前置条件：无
  * 后置条件：系统调用`questionrserviceImpl `的`getAllQuestion`方法
* `QuestionService.getQuestion`
  * 语法：`List<QuestionVO> getQuestion(Integer courseID)`
  * 前置条件：无
  * 后置条件：系统调用`questionserviceImpl `的`getQuestion`方法
* `QuestionService.createQuestion`
  * 语法：`ResultVO<QuestionVO> createQuestion(QuestionVO questionVO)`
  * 前置条件：无
  * 后置条件：系统调用`questionserviceImpl `的`createQuestion`方法
* `QuestionService.getQuestionById`
  * 语法：`ResultVO<QuestionVO> getQuestionById(Integer id)`
  * 前置条件：无
  * 后置条件：系统调用`questionserviceImpl `的`getQuestionById`方法

需要的服务（需接口）

| 服务名                                                      | 服务                     |
| ----------------------------------------------------------- | ------------------------ |
| `QuestionServiceImpl.createQuestion(QuestionVO questionVO)` | 创建新题目               |
| `QuestionServiceImpl.getQuestionById(Integer id)`           | 选择所有制定题目id的题目 |
| `QuestionServiceImpl.getAllQuestion()`                      | 选择所有题目             |
| `QuestionServiceImpl.getQuestion(Integer courseID)`         | 选择指定课程id的所有题目 |

###### 4.2.3.3.3 questionserviceImpl模块的接口规范

提供的服务（供接口）

* `QuestionServiceImpl.createQuestion`
  * 语法：` public ResultVO<QuestionVO> createQuestion(QuestionVO questionVO)`
  * 前置条件：无
  * 后置条件：系统创建包含题目信息QuestionVO的ResultVO并返回
* `QuestionServiceImpl.getQuestionById`
  * 语法：` public ResultVO<QuestionVO> getQuestionById(Integer id)`
  * 前置条件：无
  * 后置条件：系统创建包含题目信息QuestionVO的ResultVO并返回
* `QuestionServiceImpl.getAllQuestion`
  * 语法：` public List<QuestionVO> getAllQuestion()`
  * 前置条件：无
  * 后置条件：系统创建包含所有题目信息QuestionVO的ResultVO列表并返回
* `QuestionServiceImpl.getQuestion`
  * 语法：` public List<QuestionVO> getQuestion(Integer courseID)`
  * 前置条件：无
  * 后置条件：系统查询包含指定课程号的题目信息QuestionVO的ResultVO列表并返回

需要的服务（需接口）

| 服务名                                          | 服务                     |
| ----------------------------------------------- | ------------------------ |
| `QuestionMapper.insert(Question question)`      | 在数据库中添加新题目     |
| `QuestionMapper.selectAll()`                    | 选择所有题目             |
| `QuestionMapper.selectByPrimaryKey(Integer id)` | 选择所有制定题目id的题目 |

##### 4.2.3.4 业务逻辑层的动态模型

下图表明了课程学习系统中，当用户发起创建题目请求后，创建题目业务逻辑处理的相关对象之间的协作。

![img](https://upload-images.jianshu.io/upload_images/17506620-6101eabcea19cfc5.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)

其中，在QuestionServiceImpl类中，Question的变化状态图如下：

![img](https://upload-images.jianshu.io/upload_images/17506620-ee1d42f039aaab94.JPG?imageMogr2/auto-orient/strip|imageView2/2/w/1059/format/webp)



##### 4.2.3.5 业务逻辑层的设计原理

利用委托式控制风格，创建题目界面需要访问的业务逻辑由题目控制器委托给服务接口，再由题目具体类进行实现，运用了依赖倒置和面向接口编程的原则。 



#### 4.2.4 exambl

##### 4.2.4.1 模块概述

exambl模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.2.4.2 整体结构

exambl包位于业务逻辑层。根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。在展示层和业务逻辑层之间，我们添加examservice接口；在业务逻辑层和数据层之间，我们添加exammapper接口。

为了隔离业务逻辑职责和逻辑控制职责，我们增加了examcontroller，这样examcontroller会将对创建测试、查询测试信息的业务逻辑的实现委托给examservice接口，并由examserviceImpl类进行实现。ExamPO是作为题目的持久化对象被添加到设计模型中去的。运用了面向接口编程原则、依赖倒置原则。

exambl模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-dab4bfc96f9a8549.png?imageMogr2/auto-orient/strip|imageView2/2/w/999/format/webp)

exambl模块各个类的职责如下表所示。

| 模块            | 职责                                   |
| --------------- | -------------------------------------- |
| examcontroller  | 负责对接前端的接口                     |
| examservice     | 负责抽象出创建、查找测试相关方法的接口 |
| examserviceImpl | 负责实现创建、查找测试相关方法         |

##### 4.2.4.3 模块内部类的接口规范

###### 4.2.4.3.1 examcontroller模块的接口规范

提供的服务（供接口）

* `ExamController.createExam`
  * 语法：`public ResultVO<ExamVO> createExam(@RequestBody ExamVO exam)`
  * 前置条件：无
  * 后置条件：系统调用`Examservice `的`createExam`方法
* `ExamController.getCourseExam`
  * 语法：`public List<ExamVO> getCourseExam(@PathVariable Integer cid)`
  * 前置条件：无
  * 后置条件：系统调用`Examservice `的`getExam`方法
* `ExamController.getExam`
  * 语法：`public List<ExamVO> getExam()`
  * 前置条件：无
  * 后置条件：系统调用`Examservice `的`getAllExam`方法
* `ExamController.getExamById`
  * 语法：`public ExamVO getExamById(@RequestParam Integer eid)`
  * 前置条件：无
  * 后置条件：系统调用`Examservice `的`getExamById`方法
* `ExamController.getContinueExam`
  * 语法：`public List<ExamVO> getContinueExam(@RequestParam Integer courseId)`
  * 前置条件：无
  * 后置条件：系统调用`Examservice `的`getContinueExam`方法
* `ExamController.getOverExam`
  * 语法：`public List<ExamVO> getOverExam(@RequestParam Integer courseId)`
  * 前置条件：无
  * 后置条件：系统调用`Examservice `的`getOverExam`方法

需要的服务（需接口）

| 服务名                                          | 服务               |
| ----------------------------------------------- | ------------------ |
| `ExamService.createExam(ExamVO examVO)`         | 创建测试           |
| `ExamService.getAllExam()`                      | 获取所有测试       |
| `ExamService.getExam(Integer courseId)`         | 获取测试列表       |
| `ExamService.getExamById(Integer eid)`          | 根据测试号获取测试 |
| `ExamService.getContinueExam(Integer courseId)` | 获取进行中测试     |
| `ExamService.getOverExam(Integer courseId)`     | 获取已结束测试     |

###### 4.2.4.3.2 examservice模块的接口规范

提供的服务（供接口）

* `ExamService.createExam`
  * 语法：`ResultVO<ExamVO> createExam(ExamVO examVO)`
  * 前置条件：无
  * 后置条件：系统调用`ExamServiceImpl `的`createExam`方法
* `ExamService.getAllExam`
  * 语法：`List<ExamVO> getAllExam()`
  * 前置条件：无
  * 后置条件：系统调用`ExamServiceImpl `的`getAllExam`方法
* `ExamService.getExam`
  * 语法：`List<ExamVO> getExam(Integer courseId)`
  * 前置条件：无
  * 后置条件：系统调用`ExamServiceImpl `的`getExam`方法
* `ExamService.getExamById`
  * 语法：`ExamVO getExamById(Integer eid)`
  * 前置条件：无
  * 后置条件：系统调用`ExamServiceImpl `的`getExamById`方法
* `ExamService.getContinueExam`
  * 语法：`List<ExamVO> getContinueExam(Integer courseId)`
  * 前置条件：无
  * 后置条件：系统调用`ExamServiceImpl `的`getContinueExam`方法
* `ExamService.getOverExam`
  * 语法：`List<ExamVO> getOverExam(Integer courseId)`
  * 前置条件：无
  * 后置条件：系统调用`ExamServiceImpl `的`getOverExam`方法

需要的服务（需接口）

| 服务名                                              | 服务               |
| --------------------------------------------------- | ------------------ |
| `ExamServiceImpl.createExam(ExamVO examVO) `        | 创建测试           |
| `ExamServiceImpl.getAllExam() `                     | 获取所有测试       |
| `ExamServiceImpl.getExam(Integer courseId)`         | 根据课程号获取测试 |
| `ExamServiceImpl.getExamById(Integer eid)`          | 根据测试号获取测试 |
| `ExamServiceImpl.getContinueExam(Integer courseId)` | 获取进行中测试     |
| `ExamServiceImpl.getOverExam(Integer courseId)`     | 获取已结束测试     |

###### 4.2.4.3.3 examserviceImpl模块的接口规范

提供的服务（供接口）

* `ExamServiceImpl.createExam`
  * 语法：`public ResultVO<ExamVO> createExam(ExamVO examVO) ` 
  * 前置条件：无
  * 后置条件：系统创建包含测试信息ExamVO的ResultVO并返回
* `ExamServiceImpl.getAllExam`
  * 语法：`public List<ExamVO> getAllExam() `
  * 前置条件：无
  * 后置条件：系统创建包含所有测试信息ExamVO的列表并返回
* `ExamServiceImpl.getExam`
  * 语法：`public List<ExamVO> getExam(Integer courseId) `
  * 前置条件：无
  * 后置条件：系统创建包含所有指定课程号测试信息ExamVO的列表并返回
* `ExamServiceImpl.getExamById`
  * 语法：`public ExamVO getExamById(Integer eid) `
  * 前置条件：无
  * 后置条件：系统查询指定测试号的ExamVO并返回
* `ExamServiceImpl.getContinueExam`
  * 语法：`public List<ExamVO> getContinueExam(Integer courseId) `
  * 前置条件：无
  * 后置条件：系统查询指定课程号所有进行中测试信息并以列表形式返回
* `ExamServiceImpl.getOverExam`
  * 语法：`public List<ExamVO> getOverExam(Integer courseId) `
  * 前置条件：无
  * 后置条件：系统查询指定课程号所有已结束测试信息并以列表形式返回

需要的服务（需接口）

| 服务名                                      | 服务                   |
| ------------------------------------------- | ---------------------- |
| `ExamMapper.insert(Exam exam) `             | 在数据库中插入测试信息 |
| `ExamMapper.selectAll()`                    | 查询所有测试信息       |
| `ExamMapper.selectByPrimaryKey(Integer id)` | 根据测试号查询测试信息 |

##### 4.2.4.4 业务逻辑层的动态模型

下图表明了课程学习系统中，当教师发起创建测试的请求后，创建测试业务逻辑处理的相关对象之间的协作。

![img](https://upload-images.jianshu.io/upload_images/17506620-acabe8532518cc85.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)

下图表明了课程学习系统中，当学生发起查看测试信息的请求后，查看测试业务逻辑处理的相关对象之间的协作。

![img](https://upload-images.jianshu.io/upload_images/17506620-c63e562cb645d6dc.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)

其中，在ExamServiceImpl类中，Exam的变化状态图如下：

![img](https://upload-images.jianshu.io/upload_images/17506620-559c9aeb14c0a794.JPG?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)



##### 4.2.4.5 业务逻辑层的设计原理

利用委托式控制风格，创建测试和查看测试界面需要访问的业务逻辑由测试控制器委托给服务接口，再由测试具体类进行实现，运用了依赖倒置和面向接口编程的原则。 



#### 4.2.5 userexambl

##### 4.2.5.1 模块概述

userexambl模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.2.5.2 整体结构

userexambl包位于业务逻辑层。根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。在展示层和业务逻辑层之间，我们添加userexamservice接口；在业务逻辑层和数据层之间，我们添加userexammapper接口。

为了隔离业务逻辑职责和逻辑控制职责，我们增加了userexamcontroller，这样userexamcontroller会将对创建测试、查询测试信息的业务逻辑的实现委托给userexamservice接口，并由userexamserviceImpl类进行实现。UserExamPO是作为题目的持久化对象被添加到设计模型中去的。运用了面向接口编程原则、依赖倒置原则。

userexambl模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-bd524773849fe1b1.png?imageMogr2/auto-orient/strip|imageView2/2/w/1069/format/webp)

userexambl模块各个类的职责如下表所示。

| 模块                | 职责                                           |
| ------------------- | ---------------------------------------------- |
| userexamcontroller  | 负责对接前端的接口                             |
| userexamservice     | 负责抽象出作答测试、查看测试结果相关方法的接口 |
| userexamserviceImpl | 负责实现作答测试、查看测试结果相关方法         |

##### 4.2.5.3 模块内部类的接口规范

###### 4.2.5.3.1 userexamcontroller模块的接口规范

提供的服务（供接口）

* `UserExamController.setUpExam`
  * 语法：`public ResultVO<UserExamVO> setUpExam(@RequestBody UserExamVO userExam)`
  * 前置条件：无
  * 后置条件：系统调用`UserExamservice `的`setUpExam`方法
* `ExamController.getUserExam`
  * 语法：`public UserExamVO getUserExam(@RequestParam Integer userId,Integer examId)`
  * 前置条件：无
  * 后置条件：系统调用`UserExamservice `的`getUserExam`方法

需要的服务（需接口）

| 服务名                                                       | 服务         |
| ------------------------------------------------------------ | ------------ |
| `UserExamService.setUpExam(UserExamVO userexamVO)`           | 提交测试     |
| `UserExamService.getUserExam(Integer userId,Integer examId)` | 得到用户测试 |

###### 4.2.5.3.2 userexamservice模块的接口规范

提供的服务（供接口）

* `UserExamService.setUpExam`
  * 语法：`ResultVO<UserExamVO> setUpExam(UserExamVO userexamVO)`
  * 前置条件：无
  * 后置条件：系统调用`ExamServiceImpl `的`setUpExam`方法
* `UserExamService.getUserExam`
  * 语法：`List<ExamVO> getAllExam()`
  * 前置条件：无
  * 后置条件：系统调用`ExamServiceImpl `的`getUserExam`方法

需要的服务（需接口）

| 服务名                                                       | 服务             |
| ------------------------------------------------------------ | ---------------- |
| `UserExamServiceImpl.setUpExam(UserExamVO userExamVO) `      | 提交测试         |
| `UserExamServiceImpl.getUserExam(Integer userId, Integer examId) ` | 获取用户测试信息 |

###### 4.2.5.3.3 userexamserviceImpl模块的接口规范

提供的服务（供接口）

* `UserExamServiceImpl.setUpExam`
  * 语法：`public ResultVO<UserExamVO> setUpExam(UserExamVO userExamVO) ` 
  * 前置条件：无
  * 后置条件：系统创建包含用户测试信息UserExamVO的ResultVO并返回
* `UserExamServiceImpl.getUserExam`
  * 语法：`public UserExamVO getUserExam(Integer userId, Integer examId) `
  * 前置条件：无
  * 后置条件：系统返回用户测试信息UserExamVO

需要的服务（需接口）

| 服务名                                                       | 服务                                 |
| ------------------------------------------------------------ | ------------------------------------ |
| `UserExamMapper.insert(UserExam record) `                    | 在数据库中插入用户测试信息           |
| `UserExamMapper.selectByPrimaryKey(@Param(value = "examId") Integer examId, @Param(value = "userId")  Integer userId)` | 查询指定用户号和测试号的用户测试信息 |

##### 4.2.5.4 业务逻辑层的动态模型

下图表明了课程学习系统中，当学生发起作答测试的请求后，测试作答业务逻辑处理的相关对象之间的协作。

![img](https://upload-images.jianshu.io/upload_images/17506620-58473558d3b4d3c4.png?imageMogr2/auto-orient/strip|imageView2/2/w/1104/format/webp)

下图表明了课程学习系统中，当学生发起查看测试结果的请求后，测试结果查看业务逻辑处理的相关对象之间的协作。

![img](https://upload-images.jianshu.io/upload_images/17506620-e3e74f4441c75e3a.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)

其中，在UserExamServiceImpl类中，UserExam的变化状态图如下：

![img](https://upload-images.jianshu.io/upload_images/17506620-4e13ce7191a3caeb.JPG?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)



##### 4.2.5.5 业务逻辑层的设计原理

利用委托式控制风格，创建测试和查看测试界面需要访问的业务逻辑由测试控制器委托给服务接口，再由测试具体类进行实现，运用了依赖倒置和面向接口编程的原则。 



### 4.3 数据层的分解

数据层的开发包图参见软件体系结构文档。

#### 4.3.1 courseorderdata

##### 4.3.1.1 模块概述

courseorderdata模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.3.1.2 整体结构

courseorderdata包位于数据层，定义了学生租用课程订单数据的存储方式。内部包含CourseOrderMapper、CourseOrderMapperMySQLImpl模块，提供租用课程订单记录数据存储的功能，实现了职责的划分和封装。

courseorderdata模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-2eb0c10ee048a006.png?imageMogr2/auto-orient/strip|imageView2/2/w/500/format/webp)

courseorderdata模块各个类的职责如下表所示。

| 模块                       | 职责                         |
| -------------------------- | ---------------------------- |
| CourseOrderMapper          | 租用课程订单记录的接口       |
| CourseOrderMapperMySQLImpl | 提供保存、增删改查订单的服务 |

##### 4.3.1.3 模块内部类的接口规范

###### 4.3.1.3.1 courseordermapper的接口规范

提供的服务（供接口）

* `CourseOrderMapper.selectByPrimaryKey`
  * 语法：`CourseOrder selectByPrimaryKey(Integer id)`
  * 前置条件：无
  * 后置条件：系统调用`CourseOrderMapperMySQLImpl `的`selectByPrimaryKey`方法
* `CourseOrderMapper.selectByUserId`
  * 语法：``List<CourseOrder> selectByUserId(Integer userId)``
  * 前置条件：无
  * 后置条件：系统调用`CourseOrderMapperMySQLImpl `的`selectByUserId`方法
* `CourseOrderMapper.insert`
  * 语法：`int insert(CourseOrder record)`
  * 前置条件：无
  * 后置条件：系统调用`CourseOrderMapperMySQLImpl`的`insert`

需要的服务（需接口）

| 服务名                                            | 服务                       |
| ------------------------------------------------- | -------------------------- |
| `CourseOrderMapperMySQLImpl. selectByPrimaryKey ` | 查询租用订单供支付         |
| `CourseOrderMapperMySQLImpl. selectByUserId`      | 获取指定用户订单           |
| `CourseOrderMapperMySQLImpl.insert`               | 在数据库中插入租用订单记录 |

###### 4.3.1.3.2 courseordermapperMySQLImpl的接口规范

提供的服务（供接口）

* `CourseOrderMapperMySQLImpl. selectByPrimaryKey`
  * 语法：`<select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">`
  * 前置条件：无
  * 后置条件：系统按照订单ID进行查找返回相应的CourseOrderPO结果
* `CourseOrderMapperMySQLImpl. selectByUserId`
  * 语法：`<select id="selectByUserId" parameterType="java.lang.Integer" resultMap="BaseResultMap">`
  * 前置条件：无
  * 后置条件：系统按照用户ID进行查找返回相应的CourseOrderPO结果
* `CourseOrderMapperMySQLImpl.insert`
  * 语法：`<insert id="insert" parameterType="cn.seecoder.courselearning.po.order.CourseOrder" useGeneratedKeys="true" keyProperty="id">`
  * 前置条件：同样ID的PO在数据库中不存在
  * 后置条件：在数据库中增加一个CourseOrderPO记录



#### 4.3.2 viporderdata

##### 4.3.2.1 模块概述

viporderdata模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.3.2.2 整体结构

viporderdata包位于数据层，定义了学生购买会员订单数据的存储方式。内部包含VIPOrderMapper、VIPOrderMapperMySQLImpl模块，提供会员订单记录数据存储的功能，实现了职责的划分和封装。

viporderdata模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-47bea8afcf3faea3.png?imageMogr2/auto-orient/strip|imageView2/2/w/528/format/webp)

viporderdata模块各个类的职责如下表所示。

| 模块                    | 职责                             |
| ----------------------- | -------------------------------- |
| VIPOrderMapper          | 购买会员订单记录的接口           |
| VIPOrderMapperMySQLImpl | 提供保存、增删改查会员订单的服务 |

##### 4.3.2.3 模块内部类的接口规范

###### 4.3.2.3.1 vipordermapper的接口规范

提供的服务（供接口）

* `VIPOrderMapper.selectByUserId`
  * 语法：``List<VIPOrder> selectByUserId(Integer userId) ``
  * 前置条件：无
  * 后置条件：系统调用`VIPOrderMapperMySQLImpl `的`selectByUserId`方法
* `VIPOrderMapper.insert`
  * 语法：``int insert(VIPOrder record)``
  * 前置条件：无
  * 后置条件：系统调用`VIPOrderMapperMySQLImpl `的`insert`方法

需要的服务（需接口）

| 服务名                                     | 服务                       |
| ------------------------------------------ | -------------------------- |
| `VIPOrderMapperMySQLImpl. selectByUserId ` | 获取指定用户订单           |
| `VIPOrderMapperMySQLImpl.insert`           | 在数据库中插入租用订单记录 |

###### 4.3.2.3.2 courseordermapperMySQLImpl的接口规范

提供的服务（供接口）

* `VIPOrderMapperMySQLImpl. selectByUserId `
  * 语法：`<select id="selectByUserId" parameterType="java.lang.Integer" resultMap="BaseResultMap">`
  * 前置条件：无
  * 后置条件：系统按照用户ID进行查找返回相应的VIPOrderPO结果
* `VIPOrderMapperMySQLImpl.insert`
  * 语法：`<insert id="insert" parameterType="cn.seecoder.courselearning.po.order.VIPOrder" useGeneratedKeys="true" keyProperty="id">`
  * 前置条件：同样ID的PO在数据库中不存在
  * 后置条件：在数据库中增加一个VIPOrderPO记录



#### 4.3.3 questiondata

##### 4.3.3.1 模块概述

questiondata模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.3.3.2 整体结构

questiondata包位于数据层，定义了教师创建题目数据的存储方式。内部包含QuestionMapper、QuestionMapperMySQLImpl模块，提供题目数据存储的功能，实现了职责的划分和封装。

questiondata模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-52a4a031323abd2d.png?imageMogr2/auto-orient/strip|imageView2/2/w/505/format/webp)

questiondata模块各个类的职责如下表所示。

| 模块                    | 职责                         |
| ----------------------- | ---------------------------- |
| QuestionMapper          | 题目记录的接口               |
| QuestionMapperMySQLImpl | 提供保存、增删改查题目的服务 |

##### 4.3.3.3 模块内部类的接口规范

###### 4.3.3.3.1 questionmapper的接口规范

提供的服务（供接口）

* `QuestionMapper.selectAll`
  * 语法：`List<Question> selectAll()` 
  * 前置条件：无
  * 后置条件：系统调用`QuestionMapperMySQLImpl `的`selectAll`方法
* `QuestionMapper.selectByPrimaryKey(Integer id)`
  * 语法：`Question selectByPrimaryKey(Integer id)` 
  * 前置条件：无
  * 后置条件：系统调用`QuestionMapperMySQLImpl `的`selectByPrimaryKey`方法
* `QuestionMapper.insert`
  * 语法：`int insert(Question question)`
  * 前置条件：无
  * 后置条件：系统调用`QuestionMapperMySQLImpl `的`insert`方法

需要的服务（需接口）

| 服务名                                       | 服务                     |
| -------------------------------------------- | ------------------------ |
| `QuestionMapperMySQLImpl.selectAll`          | 选择所有题目             |
| `QuestionMapperMySQLImpl.selectByPrimaryKey` | 选择所有制定题目id的题目 |
| `QuestionMapperMySQLImpl.insert`             | 在数据库中添加新题目     |

###### 4.3.3.3.2 questionmapperMySQLImpl的接口规范

提供的服务（供接口）

* `QuestionMapperMySQLImpl.selectAll`
  * 语法：`<select id="selectAll" resultMap="BaseResultMap">`
  * 前置条件：无
  * 后置条件：系统查找并返回所有的QuestionPO结果
* `QuestionMapperMySQLImpl.selectByPrimaryKey`
  * 语法：`<select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">`
  * 前置条件：无
  * 后置条件：系统按照题目ID进行查找返回相应的QuestionPO结果
* `QuestionMapperMySQLImpl.insert`
  * 语法：`<insert id="insert" parameterType="cn.seecoder.courselearning.po.exam.Question" useGeneratedKeys="true" keyProperty="id">`
  * 前置条件：同样ID的PO在数据库中不存在
  * 后置条件：在数据库中增加一个QuestionPO记录



#### 4.3.4 examdata

##### 4.3.4.1 模块概述

examdata模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.3.3.2 整体结构

examdata包位于数据层，定义了教师创建测试和学生查看测试数据的存储方式。内部包含ExamMapper、ExamMapperMySQLImpl模块，提供测试记录数据存储的功能，实现了职责的划分和封装。

examdata模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-2c520598ecafd91d.png?imageMogr2/auto-orient/strip|imageView2/2/w/528/format/webp)

examdata模块各个类的职责如下表所示。

| 模块                | 职责                         |
| ------------------- | ---------------------------- |
| ExamMapper          | 测试记录的接口               |
| ExamMapperMySQLImpl | 提供保存、增删改查测试的服务 |

##### 4.3.4.3 模块内部类的接口规范

###### 4.3.4.3.1 exammapper的接口规范

提供的服务（供接口）

* `ExamMapper.selectAll`
  * 语法：``List<Exam> selectAll()`` 
  * 前置条件：无
  * 后置条件：系统调用`ExamMapperMySQLImpl `的`selectAll`方法
* `ExamMapper.selectByPrimaryKey(Integer id)`
  * 语法：`Exam selectByPrimaryKey(Integer id)`
  * 前置条件：无
  * 后置条件：系统调用`ExamMapperMySQLImpl `的`selectByPrimaryKey`方法
* `ExamMapper.insert`
  * 语法：`int insert(Exam exam) `
  * 前置条件：无
  * 后置条件：系统调用`ExamMapperMySQLImpl `的`insert`方法

需要的服务（需接口）

| 服务名                                   | 服务                   |
| ---------------------------------------- | ---------------------- |
| `ExamMapperMySQLImpl.insert `            | 在数据库中插入测试信息 |
| `ExamMapperMySQLImpl.selectAll`          | 查询所有测试信息       |
| `ExamMapperMySQLImpl.selectByPrimaryKey` | 根据测试号查询测试信息 |

###### 4.3.4.3.2 exammapperMySQLImpl的接口规范

提供的服务（供接口）

* `ExamMapperMySQLImpl.selectAll`

  * 语法：`<select id="selectAll" resultMap="BaseResultMap">`
  * 前置条件：无
  * 后置条件：系统查找并返回所有的ExamPO结果

* `ExamMapperMySQLImpl.selectByPrimaryKey`  

  * 语法：`<select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">`

  * 前置条件：无
  * 后置条件：系统按照测试ID进行查找返回相应的ExamPO结果

* `ExamMapperMySQLImpl.insert `

  * 语法：`<insert id="insert" parameterType="cn.seecoder.courselearning.po.exam.Question" useGeneratedKeys="true" keyProperty="id">`
  * 前置条件：同样ID的PO在数据库中不存在
  * 后置条件：在数据库中增加一个ExamPO记录



#### 4.3.5 userexamdata

##### 4.3.5.1 模块概述

userexamdata模块承担的需求详见需求规格文档功能需求及相关非功能需求，承担的职责及接口参见体系结构描述文档。

##### 4.3.3.2 整体结构

userexamdata包位于数据层，定义了学生已参加测试数据的存储方式。内部包含UserExamMapper、UserExamMapperMySQLImpl模块，提供学生已参加测试数据数据存储的功能，实现了职责的划分和封装。

userexamdata模块的设计如下图所示。

![img](https://upload-images.jianshu.io/upload_images/17506620-1a3e083d8c72d07e.png?imageMogr2/auto-orient/strip|imageView2/2/w/515/format/webp)

userexamdata模块各个类的职责如下表所示。

| 模块                    | 职责                                         |
| ----------------------- | -------------------------------------------- |
| UserExamMapper          | 学生已参加测试记录的接口                     |
| UserExamMapperMySQLImpl | 职责提供保存、增加、查询学生已参加测试的服务 |

##### 4.3.5.3 模块内部类的接口规范

###### 4.3.4.3.1 userexammapper的接口规范

提供的服务（供接口）

* `UserExamMapper.selectByPrimaryKey`
  * 语法：`UserExam selectByPrimaryKey(@Param(value = "examId") Integer examId, @Param(value = "userId")  Integer userId)`
  * 前置条件：无
  * 后置条件：系统调用`UserExamMapperMySQLImpl `的`selectByPrimaryKey`方法
* `UserExamMapper.insert`
  * 语法：``int insert(UserExam record) ` `
  * 前置条件：无
  * 后置条件：系统调用`UserExamMapperMySQLImpl `的`insert`方法

需要的服务（需接口）

| 服务名                                       | 服务                                 |
| -------------------------------------------- | ------------------------------------ |
| `UserExamMapperMySQLImpl.insert `            | 在数据库中插入用户测试信息           |
| `UserExamMapperMySQLImpl.selectByPrimaryKey` | 查询指定用户号和测试号的用户测试信息 |

###### 4.3.5.3.2 userexammapperMySQLImpl的接口规范

提供的服务（供接口）

* `UserExamMapperMySQLImpl.selectByPrimaryKey`  

  * 语法：`<select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">`

  * 前置条件：无
  * 后置条件：系统按照用户测试ID进行查找返回相应的UserExamPO结果

* `UserExamMapperMySQLImpl.insert `

  * 语法：`<insert id="insert" parameterType="cn.seecoder.courselearning.po.exam.UserExam" useGeneratedKeys="true" keyProperty="id">`
  * 前置条件：同样ID的PO在数据库中不存在
  * 后置条件：在数据库中增加一个UserExamPO记录



## 5.依赖视角

下面两张图是客户端和服务器端各自的包之间的依赖关系。

### 5.1 客户端包图

![](https://upload-images.jianshu.io/upload_images/17506620-f88145cc3419f829.png?imageMogr2/auto-orient/strip|imageView2/2/w/822/format/webp)

### 5.2 服务器端包图

![](https://upload-images.jianshu.io/upload_images/17506620-a267312450a972ea.png?imageMogr2/auto-orient/strip|imageView2/2/w/1151/format/webp)
